# --- nginx.conf ---
events {}

http {
    # ğŸ” Redirection HTTP â†’ HTTPS
    server {
        listen 80;
        server_name localhost;
        return 301 https://$host$request_uri;
    }

    # ğŸ”’ Serveur principal HTTPS
    server {
        listen 443 ssl;
        server_name localhost;

        # Certificats auto-signÃ©s (placÃ©s dans ./nginx/certs)
        ssl_certificate     /etc/nginx/certs/server.crt;
        ssl_certificate_key /etc/nginx/certs/server.key;

        # ğŸ” Proxy vers les microservices internes
        location /auth/ {
            proxy_pass http://auth-service:7000/;
        }

        location /files/ {
            proxy_pass http://file-service:6001/;
        }

        location /api/ {
            proxy_pass http://api-gateway:6002/;
        }

        # ğŸŒ (Optionnel) Frontend statique si tu veux y mettre un site plus tard
        location / {
            root /usr/share/nginx/html;
            index index.html;
        }
    }
}
